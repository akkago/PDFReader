# Ручная настройка PATH для Poppler Utils

## Автоматическая установка (рекомендуется)

Запустите скрипт от имени администратора:
```bash
install-poppler.bat
```

## Ручная настройка PATH

### Шаг 1: Скачивание Poppler
1. Перейдите на https://github.com/oschwartz10612/poppler-windows/releases/
2. Скачайте последнюю версию (например, `Release-23.11.0-0.zip`)
3. Распакуйте архив в `C:\poppler`

### Шаг 2: Проверка структуры
Убедитесь, что у вас есть следующая структура:
```
C:\poppler\
└── Library\
    └── bin\
        ├── pdftoppm.exe
        ├── pdftocairo.exe
        ├── pdftotext.exe
        └── другие файлы...
```

### Шаг 3: Добавление в PATH

#### Метод 1: Через PowerShell (от имени администратора)
```powershell
# Откройте PowerShell от имени администратора
$popplerPath = "C:\poppler\Library\bin"
$currentPath = [Environment]::GetEnvironmentVariable("PATH", "Machine")
$newPath = $currentPath + ";" + $popplerPath
[Environment]::SetEnvironmentVariable("PATH", $newPath, "Machine")
```

#### Метод 2: Через графический интерфейс
1. Нажмите `Win + R`, введите `sysdm.cpl`, нажмите Enter
2. Перейдите на вкладку "Дополнительно"
3. Нажмите "Переменные среды"
4. В разделе "Системные переменные" найдите `Path`
5. Нажмите "Изменить"
6. Нажмите "Создать" и добавьте: `C:\poppler\Library\bin`
7. Нажмите "ОК" во всех окнах

#### Метод 3: Через командную строку (от имени администратора)
```cmd
setx PATH "%PATH%;C:\poppler\Library\bin" /M
```

### Шаг 4: Проверка установки

#### Запустите диагностический скрипт:
```bash
check-poppler.bat
```

#### Или проверьте вручную:
```cmd
# Откройте новый терминал
pdftoppm -h
```

Если команда работает, вы увидите справку по использованию.

### Шаг 5: Перезапуск

**ВАЖНО:** После изменения PATH:
1. Закройте все терминалы/IDE
2. Откройте новый терминал
3. Проверьте команду: `pdftoppm -h`

## Устранение проблем

### Проблема: "pdftoppm не найден"
**Решение:**
1. Убедитесь, что Poppler распакован в `C:\poppler`
2. Проверьте, что файл `pdftoppm.exe` существует в `C:\poppler\Library\bin`
3. Перезапустите терминал после изменения PATH

### Проблема: "Отказано в доступе"
**Решение:**
1. Запустите командную строку/PowerShell от имени администратора
2. Повторите команды установки

### Проблема: PATH не обновился
**Решение:**
1. Перезагрузите компьютер
2. Или добавьте путь вручную через "Переменные среды"

## Альтернативные пути установки

Если вы хотите установить Poppler в другую директорию:
1. Распакуйте в нужную папку (например, `D:\tools\poppler`)
2. Добавьте в PATH путь к папке `bin` (например, `D:\tools\poppler\Library\bin`)

## Проверка в проекте

После установки Poppler:
1. Перезапустите сервер: `npm run dev`
2. Загрузите PDF файл
3. Проверьте логи - должны появиться сообщения о конвертации через Poppler

## Тестирование

Создайте тестовый PDF и запустите:
```bash
node test-pdf.js
```

Если всё работает правильно, вы увидите реальные изображения страниц вместо белых заглушек. 